todo: change to java for multiprocess